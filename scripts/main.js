"use strict";function ownKeys(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function _objectSpread(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?ownKeys(Object(n),!0).forEach((function(e){_defineProperty(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):ownKeys(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function _defineProperty(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var evt=null,data=null,border=5,margin={top:10,right:10,bottom:10,left:10},width=960-margin.left-margin.right,height=500-margin.top-margin.bottom,xScale=d3.scaleLinear().range([0,width]).interpolate(d3.interpolateRound),yScale=d3.scaleLinear().range([height,50]).interpolate(d3.interpolateRound),svg=d3.select("body").on("keydown",(function(t){evt=t})).on("keyup",(function(t){evt=null})).append("svg").attr("width",width+margin.left+margin.right).attr("height",height+margin.top+margin.bottom).attr("id",uuidv4()).attr("class","root-svg").append("g").attr("transform","translate("+margin.left+","+margin.top+")");function uuidv4(){var t=crypto.getRandomValues(new Uint16Array(8)),e=0;return"00-0-4-1-000".replace(/[^-]/g,(function(n){return(t[e++]+65536*n>>n).toString(16).padStart(4,"0")}))}function updateXScaleDomain(){xScale.domain([0,d3.max(data,(function(t){return t.x+t.width}))])}function updateYScaleDomain(){yScale.domain([0,d3.max(data,(function(t){return t.y+t.height}))])}function points(t){return[{x:t.x,y:t.y},{x:t.x+t.width/2,y:t.y+t.height},{x:t.x+t.width,y:t.y}]}function update(t,e,n){data=e.y-10>=yScale(t.y)-border?d3.map(data,(function(t){var e;return _objectSpread(_objectSpread({},t),{},(_defineProperty(e={},n,t.width),_defineProperty(e,"width",t[n]),e))})):d3.map(data,(function(t){var e;return _objectSpread(_objectSpread({},t),{},(_defineProperty(e={},n,t.tone),_defineProperty(e,"tone",t[n]),e))})),draw()}function updateHeight(t,e,n){data=d3.map(data,(function(t){var e;return _objectSpread(_objectSpread({},t),{},(_defineProperty(e={},n,t.height),_defineProperty(e,"height",t[n]),e))})),draw()}function draw(){updateXScaleDomain(),updateYScaleDomain();var t=svg.selectAll(".node").data(data,(function(t){return t.id})),e=t.enter().append("g").attr("class","node");e.append("polygon").attr("points",(function(t){return points(t).map((function(t){return[xScale(t.x),yScale(t.y)].join(",")})).join(" ")})).attr("id",(function(t){return t.id})).attr("class","triangle").attr("fill",(function(t){return d3.rgb(t.x,t.y,t.tone)})).attr("stroke-width",border).attr("stroke","black").on("click",(function(t,e){evt&&"x"===evt.key&&update(e,{x:t.x,y:t.y},"x"),evt&&"y"===evt.key&&update(e,{x:t.x,y:t.y},"y")})),e.append("path").attr("d",(function(t){return"M "+xScale(t.x+t.width/2)+" "+yScale(t.y)+" L"+xScale(t.x+t.width/2)+" "+yScale(t.y+t.height)+" z"})).attr("class","triangle-height").style("stroke","black").style("stroke-dasharray","10").style("stroke-width",border).on("click",(function(t,e){!evt||"x"!==evt.key&&"y"!==evt.key||updateHeight(e,{x:t.x,y:t.y},evt.key)})),t.select("polygon").transition().duration(500).attr("points",(function(t){return points(t).map((function(t){return[xScale(t.x),yScale(t.y)].join(",")})).join(" ")})).attr("fill",(function(t){return d3.rgb(t.x,t.y,t.tone)})),t.select("path").transition().duration(500).attr("d",(function(t){return"M "+xScale(t.x+t.width/2)+" "+yScale(t.y)+" L"+xScale(t.x+t.width/2)+" "+yScale(t.y+t.height)+" z"}))}d3.json("assets/stubs/triangles.json").then((function(t){data=d3.map(t,(function(t){return _objectSpread(_objectSpread({},t),{},{id:uuidv4()})})),draw()}));