"use strict";function ownKeys(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function _objectSpread(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?ownKeys(Object(r),!0).forEach((function(e){_defineProperty(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):ownKeys(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function _defineProperty(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var evt=null,data=null,margin={top:10,right:10,bottom:10,left:10},svg=d3.select("body").on("keydown",(function(t){evt=t})).on("keyup",(function(t){evt=null})).append("svg").attr("id",uuidv4()).attr("class","root-svg").append("g").attr("transform","translate("+margin.left+","+margin.top+")");function uuidv4(){var t=crypto.getRandomValues(new Uint16Array(8)),e=0;return"00-0-4-1-000".replace(/[^-]/g,(function(r){return(t[e++]+65536*r>>r).toString(16).padStart(4,"0")}))}function triangleContains(t,e,r,n,i,a,o,d){var c=(r-t)*(a-e)-(n-e)*(i-t);return c*((r-t)*(d-e)-(n-e)*(o-t))>0&&c*((i-r)*(d-n)-(a-n)*(o-r))>0&&c*((t-i)*(d-a)-(e-a)*(o-i))>0}function update(t,e,r){var n=t.x,i=t.y,a=t.x+t.width/2,o=t.y+t.height,d=t.x-t.width/2,c=t.y+t.height;data=triangleContains(n,i,a,o,d,c,e.x,e.y)?d3.map(data,(function(e){return _objectSpread(_objectSpread(_objectSpread({},e),e.id!==t.id&&{tone:t[r]}),e.id===t.id&&_defineProperty({},r,t.tone))})):e.y===t.y+t.height?d3.map(data,(function(e){return _objectSpread(_objectSpread(_objectSpread({},e),e.id!==t.id&&{width:t[r]}),e.id===t.id&&_defineProperty({},r,t.width))})):d3.map(data,(function(e){return _objectSpread(_objectSpread(_objectSpread({},e),e.id!==t.id&&{height:t[r]}),e.id===t.id&&_defineProperty({},r,t.height))})),draw()}function draw(){var t=svg.selectAll(".triangle").data(data,(function(t){return t.id}));t.enter().append("path").attr("class","triangle").attr("d",(function(t){return"M "+t.x+" "+t.y+" l "+t.width/2+" "+t.height+" l -"+t.width+" 0 z"})).attr("fill",(function(t){return d3.rgb(t.x,t.y,t.tone)})).attr("stroke-width","2").attr("stroke","black").on("click",(function(t,e){evt&&"x"===evt.key&&update(e,{x:t.x,y:t.y},"x"),evt&&"y"===evt.key&&update(e,{x:t.x,y:t.y},"y")})),t.transition().duration(500).attr("d",(function(t){return"M "+t.x+" "+t.y+" l "+t.width/2+" "+t.height+" l -"+t.width+" 0 z"})).attr("fill",(function(t){return d3.rgb(t.x,t.y,t.tone)}))}d3.json("/assets/stubs/triangles.json").then((function(t){data=d3.map(t,(function(t){return _objectSpread(_objectSpread({},t),{},{id:uuidv4()})})),draw()}));